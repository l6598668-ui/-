<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>NEON PORTAL</title>
    <link rel="stylesheet" href="style.css">
</head>
<body>

<header>
    <h1 class="logo">NEON PORTAL</h1>
</header>

<nav id="feature-menu">
    <div class="feature-grid">
        <button class="feature-btn" onclick="showFeature('timer-section')">タイマー</button>
        <button class="feature-btn" onclick="showFeature('unit-converter')">単位変換</button>
        <button class="feature-btn" onclick="showFeature('color-palette')">色見本帳</button>
        <button class="feature-btn" onclick="showFeature('calculator')">計算機</button>
        <button class="feature-btn" onclick="showFeature('study-counter')">学習記録</button>
        <button class="feature-btn" onclick="showFeature('flashcards')">フラッシュカード</button>
        <button class="feature-btn" onclick="showFeature('random-picker')">ランダム出題</button>
        <button class="feature-btn" onclick="showFeature('bookmarks')">お気に入り</button>
        <button class="feature-btn" onclick="showFeature('progress-bar')">学習進捗</button>
        <button class="feature-btn" onclick="showFeature('rss-reader')">RSSリーダー</button>
        <button class="feature-btn" onclick="showFeature('weather-api')">お天気</button>
        <button class="feature-btn" onclick="showFeature('voting-system')">投票システム</button>
    </div>
</nav>

<main>
    <!-- タイマー機能セクション (ストップウォッチとカウントダウンを配置) -->
    <section id="timer-section" class="feature-content active">
        <div class="timer-wrapper">
            <!-- ストップウォッチエリア -->
            <div class="timer-container stopwatch">
                <h3>STOPWATCH</h3>
                <div id="stopwatch-display" class="display">00:00</div>
                <div class="timer-controls">
                    <button id="sw-main-btn" class="feature-btn">スタート</button>
                    <button id="sw-reset-btn" class="feature-btn">リセット</button>
                </div>
            </div>

            <!-- カウントダウンエリア -->
            <div class="timer-container countdown">
                <h3>COUNTDOWN</h3>
                <p class="input-message">※半角数字で入力してください</p>
                <div class="countdown-inputs">
                    <input type="number" id="countdown-minutes-input" placeholder="分" min="0" max="99" value="0">
                    <span>:</span>
                    <input type="number" id="countdown-seconds-input" placeholder="秒" min="0" max="59" value="0">
                </div>
                <div id="countdown-display" class="display">00:00</div>
                <div class="timer-controls">
                    <button id="cd-main-btn" class="feature-btn">スタート</button>
                    <button id="cd-reset-btn" class="feature-btn">リセット</button>
                </div>
            </div>
        </div>
    </section>
    
    <!-- 他の機能セクション (空の状態) -->
    <section id="unit-converter" class="feature-content"><h2>UNIT CONVERTER</h2></section>
    <section id="color-palette" class="feature-content"><h2>COLOR PALETTE</h2></section>
    <section id="calculator" class="feature-content"><h2>CALCULATOR</h2></section>
    <section id="study-counter" class="feature-content"><h2>STUDY COUNTER</h2></section>
    <section id="flashcards" class="feature-content"><h2>FLASHCARDS</h2></section>
    <section id="random-picker" class="feature-content"><h2>RANDOM PICKER</h2></section>
    <section id="bookmarks" class="feature-content"><h2>BOOKMARKS</h2></section>
    <section id="progress-bar" class="feature-content"><h2>PROGRESS BAR</h2></section>
    <section id="rss-reader" class="feature-content"><h2>RSS READER</h2></section>
    <section id="weather-api" class="feature-content"><h2>WEATHER API</h2></section>
    <section id="voting-system" class="feature-content"><h2>VOTING SYSTEM</h2></section>

</main>

<script>
    // --- 機能切り替えロジック (変更なし) ---
    function showFeature(featureId) {
        const contents = document.querySelectorAll('.feature-content');
        contents.forEach(content => {
            content.classList.remove('active');
        });
        const target = document.getElementById(featureId);
        if (target) {
            target.classList.add('active');
        }
    }

    // --- ストップウォッチ ロジック (ボタン統合) ---
    let swInterval = null;
    let swSeconds = 0;
    const swDisplay = document.getElementById('stopwatch-display');
    const swMainBtn = document.getElementById('sw-main-btn'); // スタート/一時停止
    const swResetBtn = document.getElementById('sw-reset-btn');

    swMainBtn.addEventListener('click', () => {
        if (swInterval) {
            // 一時停止
            clearInterval(swInterval);
            swInterval = null;
            swMainBtn.textContent = 'スタート';
        } else {
            // スタート/再開
            swInterval = setInterval(updateStopwatch, 1000);
            swMainBtn.textContent = '一時停止';
        }
    });

    swResetBtn.addEventListener('click', () => {
        clearInterval(swInterval);
        swInterval = null;
        swSeconds = 0;
        swDisplay.textContent = '00:00';
        swMainBtn.textContent = 'スタート';
    });
    
    function updateStopwatch() {
        swSeconds++;
        const mins = Math.floor(swSeconds / 60);
        const secs = swSeconds % 60;
        swDisplay.textContent = 
            `${mins.toString().padStart(2, '0')}:${secs.toString().padStart(2, '0')}`;
    }


    // --- カウントダウンタイマー ロジック (ボタン統合、入力制御強化) ---
    let cdInterval = null;
    let cdSecondsRemaining = 0;
    const cdMinutesInput = document.getElementById('countdown-minutes-input');
    const cdSecondsInput = document.getElementById('countdown-seconds-input');
    const cdDisplay = document.getElementById('countdown-display');
    const cdMainBtn = document.getElementById('cd-main-btn'); // スタート/一時停止
    const cdResetBtn = document.getElementById('cd-reset-btn');

    // 入力監視イベント: 半角数字以外を排除し、最大値を制御
    function enforceHalfWidthNumeric(event) {
        let input = event.target;
        input.value = input.value.replace(/[０-９]/g, function(s) {
            return String.fromCharCode(s.charCodeAt(0) - 0xFEE0);
        }).replace(/[^0-9]/g, '');
        
        // 最大値を超えないようにする
        const max = parseInt(input.max);
        if (parseInt(input.value) > max) {
            input.value = max;
        }
    }
    cdMinutesInput.addEventListener('input', enforceHalfWidthNumeric);
    cdSecondsInput.addEventListener('input', enforceHalfWidthNumeric);


    cdMainBtn.addEventListener('click', () => {
        if (cdInterval) {
            // 一時停止
            clearInterval(cdInterval);
            cdInterval = null;
            cdMainBtn.textContent = 'スタート';
            cdMinutesInput.disabled = false;
            cdSecondsInput.disabled = false;
        } else {
            // スタート/再開
            if (cdSecondsRemaining <= 0) {
                // 初回スタート時は入力値を取得
                const minutes = parseInt(cdMinutesInput.value) || 0;
                const seconds = parseInt(cdSecondsInput.value) || 0;
                cdSecondsRemaining = minutes * 60 + seconds;
                if (cdSecondsRemaining <= 0) return; // 時間が0なら何もしない
            }

            cdInterval = setInterval(tick, 1000);
            cdMainBtn.textContent = '一時停止';
            cdMinutesInput.disabled = true;
            cdSecondsInput.disabled = true;
        }
    });

    cdResetBtn.addEventListener('click', () => {
        clearInterval(cdInterval);
        cdInterval = null;
        cdSecondsRemaining = 0;
        cdDisplay.textContent = '00:00';
        cdMainBtn.textContent = 'スタート';
        cdMinutesInput.disabled = false;
        cdSecondsInput.disabled = false;
        // 入力欄の値を初期値に戻す場合は以下のコメントアウトを外す
        // cdMinutesInput.value = 0; 
        // cdSecondsInput.value = 0;
    });
    
    function tick() {
        cdSecondsRemaining--;
        if (cdSecondsRemaining < 0) {
            clearInterval(cdInterval);
            cdInterval = null;
            cdDisplay.textContent = "DONE!";
            cdMainBtn.textContent = 'スタート';
            cdMinutesInput.disabled = false;
            cdSecondsInput.disabled = false;
            // アラームを鳴らすなど
        } else {
            updateCountdownDisplay();
        }
    }


    // ページ読み込み時の初期設定
    window.onload = () => {
        showFeature('timer-section'); // タイマーを初期表示
        // updateCountdownDisplay(); // 初期表示は00:00なので不要
    };
</script>

</body>
</html>
